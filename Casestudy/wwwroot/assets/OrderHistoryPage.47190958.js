import{Q}from"./QAvatar.abc7970b.js";import{c as i,d as l,b as x}from"./QScrollObserver.8917f4b3.js";import{Q as u}from"./QCard.43ec9f78.js";import{Q as b}from"./QBtn.5221da2d.js";import{Q as w,a as C,b as S}from"./QCardSection.60dd3341.js";import{a as y,f as k,Q as O}from"./formatutils.476d2445.js";import{C as P}from"./ClosePopup.7e03939d.js";import{f as g}from"./apiutil.4137f980.js";import{_ as D,A as B,d as N,m as n,R as _,v as c,s as t,q as e,x as d,a1 as h,t as s,a2 as p,u as V,n as v}from"./index.c0e67443.js";import"./QIcon.a78c5dab.js";import"./focus-manager.b4734f87.js";const E={setup(){B(()=>{f()});let a=N({status:"",orders:[],order:{id:null,date:null,items:[],netPrice:0,tax:0},orderSelected:!1,customer:null});const f=async()=>{try{a.status="getting order history ...",a.customer=JSON.parse(sessionStorage.getItem("customer")),a.orders=await g(`order/${a.customer.email}`),a.status=`loaded ${a.orders.length} histories.`}catch(r){console.log(r),a.status=`Error has occured: ${r.message}`}};return{state:a,formatDate:y,formatCurrency:k,selectOrder:async r=>{try{a.order.netPrice=0,a.order.tax=0,a.order.id=r,console.log(a.customer.email),a.order.items=await g(`order/${r}/${a.customer.email}`),a.order.date=y(a.order.items.at(0).dateCreated),a.orderSelected=!0,a.order.items.forEach(m=>{a.order.netPrice+=m.totalPrice}),a.order.tax=a.order.netPrice*.13}catch(m){console.log(m),a.status=`Error has occured: ${m.message}`}}}}},A={class:"text-center"},I=c("div",{class:"text-h4 q-mt-md text-primary"},"Order History",-1),T=["src"],H={class:"text-h6 text-positive"},L={class:"text-h4 q-mt-md text-primary",style:{"text-align":"center"}},z={style:{"text-align":"center"}},F={class:"text-center"},J=["src"];function M(a,f,q,r,m,R){return n(),_(h,null,[c("div",A,[I,t(Q,{class:"q-mt-md",size:"xl",square:""},{default:e(()=>[c("img",{src:"img/cart.png"},null,8,T)]),_:1}),c("div",H,d(r.state.status),1)]),t(u,{class:"q-ma-md"},{default:e(()=>[c("b",null,[t(i,{style:{bottom:"-2vh"}},{default:e(()=>[t(l,{class:"q-ml-sm text-h8 text-dark"},{default:e(()=>[s("#")]),_:1}),t(l,{class:"q-ml-sm text-h8 text-dark"},{default:e(()=>[s(" Date ")]),_:1})]),_:1})]),t(x,{separator:""},{default:e(()=>[(n(!0),_(h,null,p(r.state.orders,o=>(n(),v(i,{clickable:"",key:o.id,onClick:U=>r.selectOrder(o.id)},{default:e(()=>[t(l,null,{default:e(()=>[s(d(o.id),1)]),_:2},1024),t(l,null,{default:e(()=>[s(d(r.formatDate(o.orderDate)),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),t(w,{modelValue:r.state.orderSelected,"onUpdate:modelValue":f[0]||(f[0]=o=>r.state.orderSelected=o),"transition-show":"rotate","transition-hide":"rotate"},{default:e(()=>[t(u,{style:{width:"100%"}},{default:e(()=>[t(C,{align:"right"},{default:e(()=>[V(t(b,{flat:"",label:"X",color:"primary",class:"text-h5"},null,512),[[P]])]),_:1}),t(S,null,{default:e(()=>[c("div",L," Order "+d(r.state.order.id),1),c("div",z,d(r.formatDate(r.state.order.date)),1),c("div",F,[c("img",{src:"img/cart.png",style:{width:"100px"}},null,8,J),t(i,{style:{bottom:"-2vh",left:"-1vh"}},{default:e(()=>[t(l,{class:"col q-ml-sm text-h8 text-primary"},{default:e(()=>[s("Name")]),_:1}),t(l,{class:"col-6 q-ml-sm text-h8 text-primary"},{default:e(()=>[s("Quantities")]),_:1}),t(l,{class:"col q-ml-sm text-h8 text-primary"},{default:e(()=>[s("Extended")]),_:1})]),_:1}),t(i,{style:{bottom:"1vh",left:"-1vh"}},{default:e(()=>[t(l,{class:"col-3.5"}),t(l,{class:"col-1 q-ml-sm text-h8 text-primary"},{default:e(()=>[s(" S ")]),_:1}),t(l,{class:"col-1 q-ml-sm text-h8 text-primary"},{default:e(()=>[s(" O ")]),_:1}),t(l,{class:"col-1 q-ml-sm text-h8 text-primary"},{default:e(()=>[s(" B ")]),_:1}),t(l,{class:"col-3.5"})]),_:1}),t(O,{style:{left:"-2vh",height:"40vh",width:"100%"}},{default:e(()=>[t(u,{class:"q-ma-md"},{default:e(()=>[t(x,{separator:""},{default:e(()=>[(n(!0),_(h,null,p(r.state.order.items,o=>(n(),v(i,{key:o.id},{default:e(()=>[t(l,{class:"col-4 text-left"},{default:e(()=>[s(d(o.productName),1)]),_:2},1024),t(l,{class:"col-1 text-left"},{default:e(()=>[s(d(o.qtyS),1)]),_:2},1024),t(l,{class:"col-1 text-left"},{default:e(()=>[s(d(o.qtyO),1)]),_:2},1024),t(l,{class:"col-1 text-left"},{default:e(()=>[s(d(o.qtyB),1)]),_:2},1024),t(l,{class:"col-3 text-right"},{default:e(()=>[s(d(r.formatCurrency(o.totalPrice)),1)]),_:2},1024)]),_:2},1024))),128)),t(i,null,{default:e(()=>[t(l,{class:"col-7 text-right",style:{"font-weight":"bold"}},{default:e(()=>[s("Sub:")]),_:1}),t(l,{class:"col-4 text-right",style:{"font-weight":"bold"}},{default:e(()=>[s(d(r.formatCurrency(r.state.order.netPrice)),1)]),_:1})]),_:1}),t(i,null,{default:e(()=>[t(l,{class:"col-7 text-right",style:{"font-weight":"bold"}},{default:e(()=>[s("Tax(13%):")]),_:1}),t(l,{class:"col-4 text-right",style:{"font-weight":"bold"}},{default:e(()=>[s(d(r.formatCurrency(r.state.order.tax)),1)]),_:1})]),_:1}),t(i,null,{default:e(()=>[t(l,{class:"col-7 text-primary text-right",style:{"font-weight":"bold"}},{default:e(()=>[s("Total:")]),_:1}),t(l,{class:"col-4 text-right",style:{"font-weight":"bold"}},{default:e(()=>[s(d(r.formatCurrency(r.state.order.netPrice+r.state.order.tax)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var at=D(E,[["render",M]]);export{at as default};
